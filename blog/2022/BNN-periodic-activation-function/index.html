<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>        
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Marshal Sinaga | A Review of Periodic Activation Function Induce Stationarity (Under Construction)</title>
    <meta name="author" content="Marshal Arijona Sinaga" />
    <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.xyz/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://marshalarijona.github.io/blog/2022/BNN-periodic-activation-function/">

    <!-- Dark Mode -->
    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://marshalarijona.github.io/">Marshal Sinaga</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">Blog</a>
              </li>

              <!-- Other pages-->
              <li class="nav-item ">
                <a class="nav-link" href="/notes/">Notes</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Publications</a>
              </li>
              <!--
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/publications/">publications</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/projects/">projects</a>
                </div>
              </li>
            -->

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">A Review of Periodic Activation Function Induce Stationarity (Under Construction)</h1>
    <p class="post-meta">July 19, 2022</p>
    <p class="post-tags">
      <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>
        ·  
        <a href="/blog/tag/periodic-activation-function">
          <i class="fas fa-hashtag fa-sm"></i> periodic-activation-function</a>  
          <a href="/blog/tag/Bayesian-neural-network">
          <i class="fas fa-hashtag fa-sm"></i> Bayesian-neural-network</a>  
          <a href="/blog/tag/uncertainty-quantification">
          <i class="fas fa-hashtag fa-sm"></i> uncertainty-quantification</a>  
          
        ·  
        <a href="/blog/category/machine-learning-posts">
          <i class="fas fa-tag fa-sm"></i> machine-learning-posts</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>The main idea of this paper is to show that a BNN equipped with a periodic activation function will behave like a stationary kernel of Gaussian process, e.g. Matern Kernel, RBF kernel, etc. The stationarity term here means that our NN is translation-invariant, pushing the BNN to put the uncertainty only based on the distance of data. Please check the <a href="https://arxiv.org/pdf/2110.13572.pdf" target="_blank" rel="noopener noreferrer">paper</a> for further details.</p>

<h4 id="sin-activation-function">Sin Activation Function</h4>
<p>\(\begin{eqnarray}
\sigma(x) = \sqrt{2} \sin(x) \\
p(b) = \text{Uniform}[-\pi, \pi] 
\end{eqnarray}\)</p>

<p>The covariance function then can be written as follows:</p>

<p>\begin{equation} \label{eq:sinactivationfunction}
k(x, x^\prime) = \int p(w) \frac {1}{\pi} \int_{-\pi}^\pi \sin(wx + b) \sin(wx^\prime + b) \, db \, dw
\end{equation}</p>

<p>Note that 2 is canceled out due to coefficient of \(\sigma\). Now, let us solve the inner integral:</p>

\[\begin{eqnarray}
&amp;&amp; \int_{-\pi}^\pi \sin(wx + b) \sin(wx^\prime + b) \, db \\
&amp;=&amp;	 \int_{-\pi}^\pi \frac{1}{2} (\cos(wx + b - wx^\prime - b) - \cos(wx + b + wx^\prime + b)) \, db \\
&amp;=&amp; \frac{1}{2} \int_{-\pi}^\pi \cos(w(x -x^\prime)) - \cos(w(x + x^\prime) + 2b) \, db \\
&amp;=&amp; \frac{1}{2} [\cos(w(x -x^\prime)) b]_{- \pi}^{\pi} = \pi \cos(w(x -x^\prime))
\end{eqnarray}\]

<p>We obtained the second row by applying the property \(\sin(x) \sin(y) = 1/2 (\cos(x - y) - \cos(x + y))\). At the last row, we ignore the second term due to its periodicity variable \(2b\) (symmetric). Now, we plug the last row back to Equation \eqref{eq:sinactivationfunction} to get the following:</p>

<p>\begin{equation}
k(x, x^\prime) = \int p(w) \cos(w(x - x^\prime)) dw
\end{equation}</p>

<p>Observe that we can write \(\cos(x)\) in terms of natural exponentiation via Euler’s formula, that is \(\cos(x) = 1/2 (\exp(ix) + \exp(-ix))\), where \(i\) denotes imaginary number \(\sqrt{- 1}\). Thus, we obtain</p>

\[\begin{equation}
k(x, x^\prime) = \frac{1}{2} \int p(w) (\exp(iw(x - x^\prime)) + \exp(-iw(x - x^\prime))) \, dw
\end{equation}\]

<p>Assume that the prior is symmetric on \(w\), we can perform change of variables \(w = -w\) to obtain</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;=&amp;\frac{1}{2} \int p(w) \exp(iw(x - x^\prime)) \, dw + \frac{1}{2} \int p(-w) \exp(iw(x - x^\prime)) \, dw \\
&amp;&amp; = \int p(w) \exp(iwr) \, dw 
\end{eqnarray}\]

<p>Where \(r = x - x^\prime\). Observe that \(p(w) = \frac{1}{2\pi} S(w)\), which is want to be shown.</p>

<h4 id="sin-cos-activation-function">Sin Cos Activation Function</h4>

<p>\begin{equation}
\sigma(x) = \sin(x) + \cos(x)
\end{equation}</p>

<p>Let us assume that our single neural network is bias free. Given the activation function above, we can write the covariance function \(k(x, x^\prime)\) as follows:</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;=&amp; \int p(w) (\sin(wx) + \cos(wx)) (\sin(wx^\prime) + \cos(wx^\prime)) \, dw \\
&amp;=&amp; \int p(w) (\sin(wx) \sin(wx^\prime) + \sin(wx) \cos(wx^\prime) \nonumber \\ 
&amp;\quad&amp; + \cos(wx) \sin(wx^\prime) + \cos(wx) \cos(wx^\prime)) \, dw \\
&amp;=&amp; \int p(w) (\cos(wx - wx^\prime) + \sin(wx + wx^\prime)) \, dw \\
\end{eqnarray}\]

<p>We apply distributed rule on the first row to obtain the second row. Subsequently, applying indentitites \(\sin(x \pm y) = \sin(x) \cos(y) \pm \cos(x) \sin(y)\) and \(\cos(x \pm y) = \cos(x) \cos(y) \mp \sin(x) \sin(y)\) on the second row gives us the third row. Rewriting \(\sin\) and \(\cos\) in Euler’s form gives us</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;= \frac{1}{2} \int p(w) \exp(iw(x - x^\prime)) \, dw + \frac{1}{2} \int p(w) \exp(-iw(x - x^\prime)) \, dw \\
&amp;+ \frac{1}{2} \int p(w) i\exp(-iw(x + x^\prime)) \, dw - \frac{1}{2} \int p(w) i\exp(iw(x + x^\prime)) \, dw
\end{eqnarray}\]

<p>Since the support of \(p(w)\) is on the entire real line and with the assumption that \(p(w)\) is symmetric, we obtain</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;= \frac{1}{2} \int p(w) \exp(iw(x - x^\prime)) \, dw  + \frac{1}{2} \int p(w) \exp(-iw(x - x^\prime)) \, dw = \int p(w) \exp(iwr) \, dw \\
\end{eqnarray}\]

<p>Again with \(r = x - x^\prime\)</p>

<h4 id="triangle-wave-activation">Triangle Wave Activation</h4>

<p>We can write triangle wave activation as a parametric function</p>

<p>\begin{equation}
	\psi(x) = \frac{4}{p} \left( x - \frac{p}{2} \lfloor	\frac{2x}{p} + \frac{1}{2} \rfloor \right) (-1)^{\lfloor\frac{2x}{p} + \frac{1}{2}\rfloor}
\end{equation}</p>

<p>\(p\) is responsible to control the period of the function. The authors of the paper chose \(p=2\pi\). Now to make the analysis becomes feasible, we need to perform Fourier series approximation on \(\psi(x)\).</p>

<p>\begin{equation}
\psi(x) = \underset{n \rightarrow \infty}{\lim} \frac{8}{\pi^2} \sum_{k=0}^{n - 1} (-1)^k (2k + 1)^{-2} \sin((2k + 1)x)
\end{equation}</p>

<p>Let us assume that \(\lambda_k := 2k + 1\) and the bias is sampled from an uniform distribution. Thus, we can write our activation function as follows</p>

\[\begin{eqnarray}
&amp;&amp;\sigma(z) = \sqrt{2} \sum_{k=0}^{n - 1} (-1)^k \lambda_k^{-2} \sin(\lambda_k z) \\
&amp;&amp;p(b) = \text{Uniform}(-\pi, \pi)
\end{eqnarray}\]

<p>Note that \(\sigma\) will converge to \(\psi\) as we \(n\) goes to infinity. Subsequently, the corresponding covariance function \(k(x, x^\prime)\) will be as follows</p>

\[\begin{eqnarray}
 k(x, x^\prime) &amp;&amp;= \int p(w) \int 2p(b) [\sum_{k=0}^{n - 1} (-1)^k \lambda_k^{-2} \sin(\lambda_k (wx + b))]   \nonumber \\
 &amp;&amp; \quad [\sum_{j=0}^{n - 1} (-1)^j \lambda_j^{-2} \sin(\lambda_j (wx^\prime + b))] \, dw \, db
 \end{eqnarray}\]

<p>For now, let us solve the inner integral for the case \(k \neq j\):</p>

\[\begin{eqnarray}
 &amp;&amp;\int \frac{1}{\pi} \frac{(-1)^{k + j}}{\lambda_k^2 \lambda_j^2} [\sin(\lambda_k (wx + b))]  [\sin(\lambda_j (wx^\prime + b))] \, db  \nonumber \\
 &amp;&amp;= \frac{1}{2\pi} \frac{(-1)^{k + j}}{\lambda_k^2 \lambda_j^2} \int \cos(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j)) - \cos(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j)) \, db \nonumber \\
 &amp;&amp;= \frac{1}{2\pi} \frac{(-1)^{k + j}}{\lambda_k^2 \lambda_j^2} [\frac{\sin(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j))}{\lambda_k - \lambda_j} - \frac{\sin(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j))}{\lambda_k + \lambda_j}]_{-\pi}^{\pi} \\
 &amp;&amp;= 0 \nonumber
 \end{eqnarray}\]

<p>Note that the above integral resulted in \(0\) since both \(\lambda_k, \lambda_j\) are odd and the magnitude of the lower bound and the upper bound of integral is equal. Therefore, the remaining terms are the case where \(k = j\). We then rewrite the covariance function as follows:</p>

\[\begin{eqnarray}
 k(x, x^\prime) &amp;&amp;= \int p(w) \int 2p(b) \sum_{k=0}^{n - 1} \frac{(-1)^{2k}}{\lambda_k^4} \sin(\lambda_k (wx + b)) \sin(\lambda_k (wx^\prime + b)) \, dw \, db
 \end{eqnarray}\]

<p>Again, let us solve the inner integral for each summand. For now, we take the constant out of the inner integral and will involve them in the outer integral.</p>

\[\begin{eqnarray}
 &amp;&amp;\int_{-\pi}^{\pi} 2 p(b) \sin(\lambda_k (wx + b)) \sin(\lambda_k (wx^\prime + b)) db \nonumber \\
 &amp;&amp;= \int_{-\pi}^{\pi} \frac{1}{2 \pi} [\cos(w\lambda_k (x -  x^\prime)) - \cos(w\lambda_k (x + x^\prime) + 2b\lambda_k)] \, db \nonumber \\
 &amp;&amp;=\cos(w\lambda_k (x -  x^\prime)) 
 \end{eqnarray}\]

<p>Note that the second term in the second row is canceled out due to its even shifting coefficient and equal magnitude of lower and upper bound. Let us plug the result back to the covariance function.</p>

<p>\begin{equation}
 	k(x, x^\prime) = \int p(w) \sum_{k=0}^{n - 1} \frac{(-1)^{2k}}{\lambda_k^4} \cos(w\lambda_k (x -  x^\prime)) dw
\end{equation}</p>

<p>In order to get the exact solution, we take the limit \(n \rightarrow \infty\).</p>

<p>\begin{equation}
 	k(x, x^\prime) = \int p(w) \underset{n \rightarrow \infty}{\lim} \sum_{k=0}^{n - 1} \frac{1}{\lambda_k^4} \cos(w\lambda_k (x -  x^\prime)) dw
\end{equation}</p>

<p>The equation above is based on the fact that \((-1)^{2k} = 1\) for \(k \in \mathbb{N} \geq 0\). Next, we need the dominated convergence theorem to take the limit outside of the integral. Let \(f(n) = p(w) \sum_{k=0}^{n - 1} \frac{1}{\lambda_k^4} \cos(w\lambda_k (x -  x^\prime))\). Then, it requires another function \(g(n)\) s.t. \(\vert f_n(w) \vert \geq g(w), \forall n\) and \(\int g(w) dw &lt; \infty\)</p>

\[\begin{eqnarray}
\vert f_n(w) \vert &amp;&amp;= \sum_{k=0}^{n - 1} \frac{1}{(2k + 1)^4} \cos(w \lambda_k (x -  x^\prime)) \\
&amp;&amp; \leq p(w) \sum_{k=0}^{n - 1} \frac{1}{(2k + 1)^4} \\
&amp;&amp; \leq p(w) \sum_{k=0}^{n - 1} \frac{1}{k^4} = \frac{\pi ^ 4}{90} p(w)
\end{eqnarray}\]

<p>Furthermore, we have \(\int \pi^4/90 p(w) dw = \pi^4 / 90 &lt; \infty\). Since \(g(w)\) satisfies all constraints, we can rewrite \(k(x, x^\prime)\) as follows:</p>

<p>\begin{equation}
k(x, x^\prime) = \underset{n \rightarrow \infty}{\lim} \int p(w) \sum_{k=0}^{n - 1} \frac{1}{\lambda_k^4} \cos(w \lambda_k (x -  x^\prime)) dw
\end{equation}</p>

<p>We also can rewrite the above equation in the form of mixture density(assuming the density \(p\) is a member of location-scale family, which is the case in this paper). By applying the Euler’s form we can write the covariance function as follows:</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;&amp;= \underset{n \rightarrow \infty}{\lim} \int \sum_{k=0}^{n - 1} p(w) \frac{1}{\lambda_k^4} \exp(i \lambda_k w (x -  x^\prime)) \, dw \\
&amp;&amp; = \underset{n \rightarrow \infty}{\lim} \int \sum_{k=0}^{n - 1} p(w) \pi_k \exp(i \lambda_k w (x -  x^\prime)) \, dw \\
&amp;&amp; = \underset{n \rightarrow \infty}{\lim} \int \sum_{k=0}^{n - 1} p(w \vert \lambda_k) \pi_k \exp(iw (x -  x^\prime)) \, dw \\
\end{eqnarray}\]

<p>Let \(\hat{p}(w) = \underset{n \rightarrow \infty}{\lim} \sum_{k=0}^{n - 1} p(w \vert \lambda_k) \pi_k\) and \(r = x - x^\prime\), we recover the Wiener-Kinchin theorem</p>

<p>\begin{equation}
k(x, x^\prime) = \int \hat{p}(w) \exp(iwr) \, dw
\end{equation}</p>

<h4 id="periodic-relu-activation">Periodic ReLU Activation</h4>

<p>We can write the periodic ReLU function as a sum of triangle wave activation function with the second term is shifted by half a period from the first term.</p>

<p>\begin{equation}
\psi(x) = \frac{2}{\pi} (((x + \frac{\pi}{2}) - \pi \lfloor \frac{(x + \frac{\pi}{2})}{\pi} + \frac{1}{2} \rfloor) (-1)^{\lfloor \frac{(x + \frac{\pi}{2})}{\pi} + \frac{1}{2} \rfloor} + (x - \pi \lfloor \frac{x}{\pi}  + \frac{1}{2} \rfloor) (-1)^{\lfloor \frac{x}{\pi}  + \frac{1}{2} \rfloor})
\end{equation}</p>

<p>Again, we approximate \(\psi(x)\) through Fourier transformation to obtain</p>

<p>\begin{equation}
\sigma(x) = \underset{n \rightarrow \infty}{lim} \sum_{k=0}^{n - 1} (-1)^k \lambda_k^{-2} (\sin(\lambda_k (x + \frac{\pi}{2}))  + \sin(\lambda_k x))
\end{equation}</p>

<p>With \(p(b) = \text{Uniform}[-\pi, \pi]\). Given the above activation function, we can define the covariance function as follows</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;&amp;= \int p(w) \int p(b) [\underset{n \rightarrow \infty}{\lim} \sum_{k=0}^{n-1} (-1)^k \lambda_k^{-2} (\sin(\lambda_k (wx + b + \frac{\pi}{2})) + \sin(\lambda_k(wx + b)))] \nonumber \\
&amp;&amp; \quad  [\underset{n \rightarrow \infty}{\lim} \sum_{j=0}^{n-1} (-1)^j \lambda_j^{-2} (\sin(\lambda_j (wx^\prime + b + \frac{\pi}{2})) + \sin(\lambda_j(wx^\prime + b)))] \, db \, dw
\end{eqnarray}\]

<p>Let us solve all the integrals with the case \(k \neq j\)</p>

\[\begin{eqnarray} \label{eq:prelucovariance} 
\int_{-\pi}^{\pi} &amp;&amp;p(b) \frac{(-1)^{j + k}}{\lambda_k^2 \lambda_j^2} (\sin(\lambda_k (wx + b + \frac{\pi}{2})) + \sin(\lambda_k(wx + b))) (\sin(\lambda_j (wx^\prime + b + \frac{\pi}{2})) + \sin(\lambda_j(wx^\prime + b))) \, db
\end{eqnarray}\]

<p>Now, let us use the following trigonometry identity</p>

<p>\(\sin(\lambda_k(wx + b + \frac{\pi}{2})) = (-1)^{k} \cos(\lambda_k(wx + b))\).</p>

<p>Plugging the above identity back to Equation \eqref{eq:prelucovariance}, we obtain</p>

\[\begin{eqnarray}
\frac{1}{2\pi} \frac{(-1)^{j + k}}{\lambda_k^2 \lambda_j^2} \int_{-\pi}^{\pi}  ((-1)^{k} \cos(\lambda_k(wx + b)) + \sin(\lambda_k(wx + b))) ((-1)^{j}\cos(\lambda_j(wx^\prime + b)) + \sin(\lambda_j(wx^\prime + b))) \, db  \nonumber \\
\end{eqnarray}\]

<p>Observe that we can extend the form above into 4 terms. For now, let us solve the integral for each term of the extended form above.</p>

<p><strong>Integral 1</strong></p>

\[\begin{eqnarray}
&amp;&amp; \int_{- \pi}^{\pi} (-1)^{j + k} \cos(\lambda_k(wx + b)) \cos(\lambda_j(wx^\prime + b)) \, db \nonumber \\
&amp;&amp;= \frac{1}{2} \int \cos(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j)) + \cos(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j)) db \nonumber \\
&amp;&amp;= \frac{1}{2} [\frac{\sin(w(\lambda_kx + \lambda_j x^\prime) + b(\lambda_k + \lambda_j))}{\lambda_k + \lambda_j} + \frac{\sin(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j))}{\lambda_k - \lambda_j}]_{-\pi}^{\pi} \nonumber \\
&amp;&amp;= 0 \nonumber
\end{eqnarray}\]

<p>We applied the identity \(\cos(x) \cos(y) = \frac{1}{2} (\cos(x + y) + \cos(x - y))\) to obtain the second row. Note that \(\lambda_k, \lambda_j\) are even, thus we have even shifting coefficient for each term. Since the lower bound and the upper bound are symmetric, we obtain \(0\).</p>

<p><strong>Integral 2</strong></p>

\[\begin{eqnarray}
&amp;&amp; \int_{- \pi}^{\pi} \sin(\lambda_k(wx + b)) \sin(\lambda_j(wx^\prime + b)) \, db \nonumber \\
&amp;&amp;= \frac{1}{2} \int_{- \pi}^{\pi} \cos(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j)) - \cos(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j)) \, db \nonumber \\
&amp;&amp;= \frac{1}{2} [\frac{\sin(w(\lambda_k x - \lambda_j x^\prime) + b(\lambda_k - \lambda_j))}{\lambda_k - \lambda_j} - \frac{\sin(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j))}{\lambda_k + \lambda_j}] \nonumber \\
&amp;&amp;= 0 \nonumber
\end{eqnarray}\]

<p>We applied the identity \(\sin(x) \sin(y) = \frac{1}{2} (\cos(x - y) - \cos(x + y))\) to obtain the second row. Due to the even shifting coefficient and symmetricity, we end up with \(0\).</p>

<p><strong>Integral 3</strong></p>

\[\begin{eqnarray}
&amp;&amp; \int_{- \pi}^{\pi} (-1)^k \cos(\lambda_k(wx + b)) \sin(\lambda_j(wx^\prime + b)) \, db  \nonumber \\
&amp;&amp;= \frac{(-1)^k}{2} \int_{- \pi}^{\pi}  \sin(w(\lambda_kx + \lambda_jx^\prime) + b(\lambda_k + \lambda_j)) + \sin(w(\lambda_jx^\prime - \lambda_kx) + b(\lambda_j - \lambda_k)) \nonumber \\
&amp;&amp;= \frac{(-1)^k}{2} [\frac{- \cos(w(\lambda_k x + \lambda_j x^\prime) + b(\lambda_k + \lambda_j))}{\lambda_k + \lambda_j} - \frac{\cos(w(\lambda_j x^\prime - \lambda_k x) + b(\lambda_j - \lambda_k))}{\lambda_j - \lambda_k}] \nonumber \\
&amp;&amp;= 0 \nonumber
\end{eqnarray}\]

<p>We applied the identity \(\sin(x) \cos(y) = \frac{1}{2} (\sin(x + y) + \sin(x - y))\) to obtain the second row. Due to the even shifting coefficient and symmetricity, we end up with \(0\).</p>

<p><strong>Integral 4</strong></p>

\[\begin{eqnarray}
&amp;&amp; \int_{- \pi}^{\pi} (-1)^j \cos(\lambda_j(wx^\prime + b)) \sin(\lambda_k(wx + b)) = 0 \, db  \nonumber \\
\end{eqnarray}\]

<p>Following the exact steps in Integral 3, we obtain the same result for Integral 4. Now our integral only involves the term where \(j = k\). Thus we can rewrite the covariance function as follows</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;&amp;= \int p(w) \int p(b) [\underset{n \rightarrow \infty}{\lim} \sum_{k=0}^{n-1} (-1)^k \lambda_k^{-2} (\sin(\lambda_k (wx + b + \frac{\pi}{2})) + \sin(\lambda_k(wx + b))) \nonumber \\
&amp;&amp; \quad (-1)^k \lambda_k^{-2} (\sin(\lambda_k (wx^\prime + b + \frac{\pi}{2})) + \sin(\lambda_k(wx^\prime + b)))] \, db \, dw
\end{eqnarray}\]

<p>By the dominant convergence theorem, we could plug the limit out of the integral and obtain</p>

\[\begin{eqnarray}
k(x, x^\prime) &amp;&amp;= \underset{n \rightarrow \infty}{\lim} \int p(w)  \sum_{k=0}^{n-1} (-1)^{2k} \lambda_k^{-4} \int p(b) (\sin(\lambda_k (wx + b + \frac{\pi}{2})) + \sin(\lambda_k(wx + b))) \nonumber \\
&amp;&amp; \quad (\sin(\lambda_k (wx^\prime + b + \frac{\pi}{2})) + \sin(\lambda_k(wx^\prime + b))) \, db \, dw \label{eq:almostcovarianceprelu}
\end{eqnarray}\]

<p>Let us solve the inner integral</p>

\[\begin{eqnarray}
&amp;&amp;\int_{- \pi}^{\pi} p(b) ((-1)^{k} \cos(\lambda_k (wx + b)) + \sin(\lambda_k(wx + b))) ((-1)^k \cos(\lambda_k (wx^\prime + b)) + \sin(\lambda_k(wx^\prime + b))) \, db \nonumber \\
&amp;&amp;= \int_{- \pi}^{\pi} p(b) ((-1)^{2k} \cos(\lambda_k (wx + b)) \cos(\lambda_k (wx^\prime + b)) + (-1)^k \cos(\lambda_k (wx + b)) \sin(\lambda_k(wx^\prime + b)) \nonumber \\
&amp;&amp; \quad + (-1)^{k} \sin(\lambda_k(wx + b)) \cos(\lambda_k (wx^\prime + b)) + \sin(\lambda_k(wx + b)) \sin(\lambda_k(wx^\prime + b)))  \, db \nonumber \\
&amp;&amp;= \int_{- \pi}^{\pi} p(b) ((-1)^{2k} \cos(w\lambda_k(x - x^\prime)) + (-1)^k \sin(w\lambda_k(x + x^\prime) + 2b\lambda_k)) \, db \nonumber \\
&amp;&amp;= \frac{1}{2 \pi} [(-1)^{2k} \cos(w\lambda_k(x - x^\prime)) b - (-1)^k \cos(w\lambda_k(x + x^\prime) + 2b\lambda_k) / 2 \lambda_k]_{- \pi}^\pi  \nonumber \\
&amp;&amp;= (-1)^{2k} \cos(w \lambda_k(x - x^\prime)) \nonumber \\
&amp;&amp;= \cos(w \lambda_k(x - x^\prime))
\end{eqnarray}\]

<p>we obtained the third row by applying the identitites \(\sin(x \pm y) = \sin(x) \cos(y) \pm \cos(x) \sin(y)\) and \(\cos(x \pm y) = \cos(x) \cos(y) \mp \sin(x) \sin(y)\). Since \(2k\) is guaranted to be even, we have \((-1)^{2k} = 1\). Now we insert the obtained equation to Equation \eqref{eq:almostcovarianceprelu}</p>

<p>\begin{equation}
k(x, x^\prime) = \underset{n \rightarrow \infty}{\lim} \int p(w) \sum_{k=0}^{n-1} (-1)^{2k} \lambda_k^{-4} \cos(w \lambda_k(x - x^\prime)) \, dw
\end{equation}</p>

<p>We can approximate the equation above by choosing only the first term. Furthermore, applying Euler’s formula on the first term will give us</p>

<p>\begin{equation}
k(x, x^\prime) = \int p(w) \exp(iwr)  \, dw
\end{equation}</p>

<p>Where \(r = x - x^\prime\)</p>


  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Marshal Arijona Sinaga. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Mansory & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/mansory.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

